# This workflow demonstrates a matrix build strategy with artifact management.
# It runs builds for multiple Python versions in parallel, and each job
# uploads its own unique artifact.

name: Python Matrix Build

# Triggers the workflow on push events to the main branch
on:
  push:
    branches:
      - main
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  build:
    # Job name includes the matrix variable for better readability in the UI
    name: Build (Python ${{ matrix.python-version }})
    
    # Run jobs on the latest Ubuntu runner
    runs-on: ubuntu-latest
    
    # Define the matrix strategy
    strategy:
      fail-fast: false # Don't cancel other jobs if one fails
      matrix:
        python-version: ['3.9', '3.10', '3.11'] # Three different variants

    steps:
      # Step 1: Check out the repository's code
      - name: Check out code
        uses: actions/checkout@v4

      # Step 2: Set up the specific Python version for this matrix job
      - name: Set up Python ${{ matrix.python-version }}
        uses: actions/setup-python@v5
        with:
          python-version: ${{ matrix.python-version }}

      # Step 3: A step with the required identifier
      - name: Run Matrix Step (matrix-beeda5a)
        id: matrix-beeda5a # The required step identifier
        run: |
          echo "Running build for Python version: ${{ matrix.python-version }}"
          python --version

      # Step 4: Generate a unique build artifact
      - name: Generate build artifact
        run: |
          echo "This is the build artifact for Python ${{ matrix.python-version }}." > build_output.txt
          echo "Generated on $(date)" >> build_output.txt

      # Step 5: Upload the unique artifact for this matrix job
      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          # Name the artifact uniquely based on the matrix variable
          name: build-beeda5a-python${{ matrix.python-version }}
          # Path to the file(s) to upload
          path: build_output.txt
          # Retention days (optional, defaults to 90)
          retention-days: 7
